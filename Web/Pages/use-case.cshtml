@page "{id:int}"
@model UseCaseModel
@{
    ViewBag.Title = Localizer.GetString("title", Model.UseCase.Number, Model.UseCase.Title);
}

<h1>@ViewBag.Title</h1>
<code>@Model.UseCase.Id</code>
<p>@Model.UseCase.Description</p>

@if (Model.UseCase.Links.Any())
{
    <fieldset>
        <legend>
            @Localizer["related requirements"]</legend>
        <ul>
            @foreach (var category in Model.UseCase.Links.SelectMany(x => x.Requirement.Categories).Distinct())
            {
                <li>
                    <fieldset>
                        <legend>@category.Number - <a asp-page="requirement-category" asp-route-id="@category.Number">@category.Title</a></legend>
                        <ul>
                            @foreach (var link in Model.UseCase.Links.Where(x => x.Requirement.Categories.Contains(category)))
                            {
                                <li>
                                    @link.Requirement.Number - <a asp-page="requirement" asp-route-id="@link.Requirement.Number">@link.Requirement.Title</a>
                                    <blockquote>@link.Comment</blockquote>
                                </li>
                            }
                        </ul>
                    </fieldset>
                </li>
            }
            <li>
                <fieldset>
                    <legend>@Localizer["uncategorized"]</legend>
                    <ul>
                        @foreach (var link in Model.UseCase.Links.Where(x => !x.Requirement.Categories.Any()))
                        {
                            <li>
                                @link.Requirement.Number - <a asp-page="requirement" asp-route-id="@link.Requirement.Number">@link.Requirement.Title</a>
                                <blockquote>@link.Comment</blockquote>
                            </li>
                        }
                    </ul>
                </fieldset>
            </li>
        </ul>
    </fieldset>
}
